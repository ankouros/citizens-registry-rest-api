# Citizen Registry REST API

### Spring Boot • JPA • Testing • CI/CD

---

## 1. l3687-Μηχανική Μοντέρνων Εφαρμογών Παγκοσμίου Ιστού 

### 1.1 Στόχοι ενότητας

Η ενότητα αυτή εστιάζει στον σχεδιασμό και την υλοποίηση μοντέρνων web εφαρμογών με:

- **RESTful αρχιτεκτονική**
- **επίπεδη αρχιτεκτονική εφαρμογής** (controller–service–repository–domain)
- **καθαρή οργάνωση κώδικα** σε υπο-έργα (multi-module Maven)
- **τεκμηριωμένη διαδικασία ανάπτυξης και δοκιμών**

Στο πλαίσιο της ενότητας, το παρόν έργο λειτουργεί ως ολοκληρωμένο case study μιας
καλά δομημένης Spring Boot REST εφαρμογής με επίμονο επίπεδο δεδομένων (persistence).

### 1.2 Γενική Περιγραφή

Το παρόν έργο υλοποιεί μία **RESTful υπηρεσία μητρώου πολιτών** με χρήση του
**Spring Boot** και οργανώνεται ως **σύνθετο Maven έργο (multi-module)**.

Η υλοποίηση καλύπτει **όλα τα βασικά και προαιρετικά ζητούμενα** των ασκήσεων
του μαθήματος, συμπεριλαμβανομένων:

- Persistence (ORM)
- Client εφαρμογής
- Unit, ORM και Integration tests
- CI/CD αγωγού με GitHub Actions

Το έργο έχει αναπτυχθεί με έμφαση:

- στη σωστή, πολυεπίπεδη αρχιτεκτονική
- στην καθαρή οργάνωση κώδικα (modules, πακέτα, υπευθυνότητες)
- στην πλήρη κάλυψη των προβλεπόμενων απαιτήσεων αξιολόγησης, σύμφωνα με την εκφώνηση

---

### 1.3 Δομή Έργου (Multi-Module Maven)

```text
citizens-registry-rest-api/
├── citizen-domain   # Domain / Entity classes (JPA)
├── citizen-service  # Spring Boot RESTful Service
├── citizen-client   # Spring Boot CLI Client (προαιρετικό)
├── citizen-it     # Integration Tests (Rest-Assured)
└── pom.xml      # Parent POM
```

### 1.4 Υπο-Έργα & Ρόλος

### 1️⃣ citizen-domain

**Ρόλος:** Κλάσεις πεδίου / Οντότητες (Domain Model)

- Οντότητα `Citizen`
- Πεδία:
 - id
 - firstName
 - lastName
 - afm
 - amka
 - birthDate
- Χρήση **Jakarta Persistence (JPA)**
- **Unit tests οντοτήτων** (constructors, getters/setters)

 Καλύπτει τις απαιτήσεις δοκιμών μονάδων οντοτήτων σύμφωνα με την εκφώνηση.
----------------------

### 2️⃣ citizen-service

**Ρόλος:** RESTful υπηρεσία (Spring Boot)

- CRUD λειτουργίες:
 - `GET /citizens`
 - `GET /citizens/{id}`
 - `POST /citizens`
 - `PUT /citizens/{id}`
 - `DELETE /citizens/{id}`
- Spring Data JPA Repository
- In-memory βάση δεδομένων **H2**
- Καθαρός διαχωρισμός:
 - Controller (REST layer)
 - Service (business logic)
 - Repository (persistence)

#### Δοκιμές στο citizen-service

- **Configuration Tests** (Spring Context & Beans)
- **ORM Tests** (save / find / delete μέσω JPA)
- **Unit Tests επιχειρησιακής λογικής**

 Καλύπτει:

- Δοκιμές ρύθμισης
- Δοκιμές ORM
- Unit tests λογικής

---

### 3️⃣ citizen-client *(Προαιρετικό)*

**Ρόλος:** Κώδικας πελάτη (CLI)

- Spring Boot εφαρμογή γραμμής εντολών
- Διαδραστικό menu:
 - Λίστα πολιτών
 - Δημιουργία πολίτη
 - Έξοδος
- Επαναχρησιμοποίηση domain classes
- Δεν εκκινεί web server
 (`spring.main.web-application-type=none`)

 Καλύπτει το **1ο προαιρετικό ζητούμενο**, σύμφωνα με τις προβλεπόμενες απαιτήσεις

---

### 4️⃣ citizen-it *(Προαιρετικό)*

**Ρόλος:** Δοκιμές ενοποίησης

- Χρήση **Rest-Assured**
- Εκκίνηση πραγματικού Spring Boot server
- Maven **Failsafe Plugin**
- Δοκιμή όλων των REST endpoints

 Δοκιμάζονται **και οι 5 REST μέθοδοι**

---

### 1.5 Τεχνολογίες

- Java 17
- Spring Boot
- Spring Data JPA
- Maven (multi-module)
- H2 Database
- JUnit 5
- Rest-Assured
- GitHub Actions (CI/CD)

---

### 1.6 Εκτέλεση Εφαρμογής

### Εκκίνηση REST Service

```bash
mvn -pl citizen-service spring-boot:run
```

### Εκκίνηση Client

```bash
mvn -pl citizen-client spring-boot:run
```

---

### 1.7 Εκτέλεση Tests

```bash
mvn clean verify
```

Η εντολή `mvn clean verify`:

- εκτελεί **unit tests** (Surefire) σε όλα τα modules
- εκτελεί **integration tests** (Failsafe) στο module `citizen-it`

 **BUILD SUCCESS – όλα τα tests επιτυχή**

---

### 1.8 Σύνδεση με απαιτήσεις εκφώνησης

Με βάση τα παραπάνω, για την ενότητα l3687 καλύπτονται:

- η υλοποίηση ολοκληρωμένης **RESTful υπηρεσίας** με CRUD endpoints
- η ύπαρξη **επίμονου επιπέδου δεδομένων (persistence / ORM)** με JPA και H2
- η χρήση **σύνθετου Maven έργου (multi-module)** με σαφή διαχωρισμό ευθυνών
- η ανάπτυξη **client εφαρμογής** (CLI) που αξιοποιεί το REST API
- η δημιουργία **unit tests**, **ORM tests** και **integration tests**

Η βαθμολόγηση μπορεί να τεκμηριωθεί απευθείας από τις αντίστοιχες ενότητες του κώδικα
(`citizen-domain`, `citizen-service`, `citizen-client`, `citizen-it`) και τα αντίστοιχα
αρχεία δοκιμών.

---

## 2. l3688-Συνεχής Ενοποίηση και Παράδοση (CI/CD) 

### 2.1 Στόχοι ενότητας

Η ενότητα αυτή εστιάζει στην:

- αυτοματοποίηση του κύκλου build–test μέσω εργαλείων **CI/CD**
- συστηματική εκτέλεση **unit** και **integration tests** σε κάθε αλλαγή κώδικα
- παραγωγή και αρχειοθέτηση **αναφορών δοκιμών (test reports)** ως artifacts
- διασφάλιση σταθερότητας κώδικα πριν από τη συγχώνευση σε κεντρικά branches

### 2.2 Υλοποίηση στο παρόν έργο

Το έργο χρησιμοποιεί **GitHub Actions** (`.github/workflows/ci.yml`) για συνεχή ενοποίηση. Ο αγωγός:

- ενεργοποιείται σε `push` και `pull_request` προς το branch `develop`
- κάνει checkout του repository
- ρυθμίζει JDK 17 (Temurin) με Maven cache
- εκτελεί `mvn clean test` για build και unit tests σε όλα τα modules
- εκκινεί την εφαρμογή `citizen-service` και ελέγχει το `/actuator/health` μέχρι να είναι `UP`
- εκτελεί integration tests με `mvn verify -pl citizen-it -am` (Rest-Assured + Failsafe)
- ανεβάζει ως **artifacts**:
 - unit test reports: `**/target/surefire-reports/*.xml`
 - integration test reports: `**/target/failsafe-reports/*.xml`

Ο αγωγός επομένως καλύπτει τόσο τη συνεχή ενοποίηση του κώδικα (CI) όσο και τη συνεχή επιβεβαίωση
της ορθότητας μέσω αυτοματοποιημένων δοκιμών. Η διαδικασία CI/CD είναι αναπαραγώγιμη σε οποιοδήποτε περιβάλλον διαθέτει GitHub Actions runner με JDK 17, διασφαλίζοντας συνεπή και επαναλήψιμα αποτελέσματα εκτέλεσης..

### 2.3 Παραδοτέα και αξιολόγηση

Για την ενότητα l3688 παραδίδονται:

- πλήρως λειτουργικό **GitHub Actions workflow** (`CI - Citizens Registry`)
 που ικανοποιεί τις προβλεπόμενες απαιτήσεις της ενότητας
- αυτοματοποιημένη εκτέλεση build, unit tests και integration tests
- συλλογή και αποθήκευση των **test reports** ως artifacts

Τα παραπάνω τεκμηριώνουν την κάλυψη των απαιτήσεων της ενότητας CI/CD, καθώς:

- κάθε αλλαγή στο branch `develop` ελέγχεται αυτόματα
- αποτρέπεται η εισαγωγή μη δοκιμασμένων αλλαγών
- παρέχεται αναπαραγώγιμη διαδικασία αξιολόγησης (μέσω των artifacts)

---

## Στρατηγική και Κάλυψη Δοκιμών

Η στρατηγική δοκιμών του έργου ακολουθεί πολυεπίπεδη προσέγγιση, ώστε να
διασφαλίζεται η ορθότητα της εφαρμογής από το επίπεδο των οντοτήτων
(domain model) έως και το επίπεδο ενοποίησης του REST API.

Η πλήρης και αναλυτική κάλυψη αποτυπώνεται στον παρακάτω πίνακα (Coverage Matrix).

---

## Κάλυψη Δοκιμών (Test Coverage Matrix)

Ο ακόλουθος πίνακας συνοψίζει, σε μορφή matrix, τη σχέση ανάμεσα στα υπο-έργα, τα είδη δοκιμών,
τις κλάσεις / endpoints που ελέγχονται και την αντίστοιχη ενότητα μαθήματος.

| Υπο-έργο (Module) | Τύπος δοκιμής      | Κλάσεις ή Endpoints                      | Τι ελέγχεται                                                                                             | Ενότητα μαθήματος                |
| ------------------------ | ------------------------------------ | --------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------- |
| citizen-domain      | Unit (Entities)           | `Citizen`                              | Ορθότητα domain μοντέλου, constructors/getters/setters και βασική εγκυρότητα πεδίων                                          | l3687 – Μηχανική Μοντέρνων Εφαρμογών |
| citizen-service     | Unit (Configuration)         | `ConfigurationTest` / Spring Beans                 | Φόρτωση Spring context, διαθεσιμότητα βασικών beans και χειρισμός βασικών σφαλμάτων ρύθμισης                           | l3687, l3688                          |
| citizen-service     | Unit (ORM / Repository)       | `CitizenRepository`                         | Λειτουργία JPA/H2: save/find/delete και βασικοί περιορισμοί συνέπειας δεδομένων                                        | l3687 – Persistence / ORM                   |
| citizen-service     | Unit (Business Logic)        | `CitizenService`                          | CRUD λογική, έλεγχος εγκυρότητας εισόδων, βασικές επιχειρησιακές εξαιρέσεις και αναμενόμενες οριακές περιπτώσεις | l3687 – RESTful υπηρεσία & business layer       |
| citizen-it        | Integration (REST API, Rest-Assured) | `CitizenApiIT` / REST endpoints (`/citizens`, `/citizens/{id}`) | End-to-end ροή αιτημάτων/απαντήσεων και χειρισμός τυπικών σφαλμάτων HTTP σε πραγματικό server                           | l3687, l3688                          |

Ο πίνακας αποδεικνύει ότι η κάλυψη δοκιμών είναι:

- οριζόντια (σε όλα τα modules)
- κάθετη (από επίπεδο οντότητας έως επίπεδο REST API)
- ευθυγραμμισμένη με τις απαιτήσεις των ενοτήτων l3687 και l3688.

---

### Αντιστοίχιση Δοκιμών με Κριτήρια Αξιολόγησης

Ο παρακάτω πίνακας αποτυπώνει ρητά τη σύνδεση των υλοποιημένων δοκιμών
με τα κριτήρια βαθμολόγησης της εκφώνησης:

| Κατηγορία Δοκιμών              | Module     | Κάλυψη |
| ----------------------------------------------------------- | --------------- | ------------ |
| Unit tests οντοτήτων (Entities)          | citizen-domain |      |
| Δοκιμές ρύθμισης (Spring Context)      | citizen-service |      |
| Δοκιμές ORM / Repository               | citizen-service |      |
| Δοκιμές επιχειρησιακής λογικής | citizen-service |      |
| Δοκιμές ενοποίησης REST API (Rest-Assured) | citizen-it   |      |

Με βάση τα παραπάνω, η κάλυψη δοκιμών ικανοποιεί πλήρως τα κριτήρια αξιολόγησης
των αντίστοιχων ενοτήτων.

---

## Κάλυψη Αξιολόγησης

---

Ο παρακάτω πίνακας συνοψίζει την κάλυψη των απαιτήσεων του μαθήματος:

| Απαίτηση            | Κάλυψη |
| -------------------------------------- | ------------ |
| RESTful λειτουργικότητα |      |
| Persistence / ORM           |      |
| Maven οργάνωση         |      |
| Client εφαρμογή        |      |
| Unit tests οντοτήτων     |      |
| Configuration tests          |      |
| ORM tests               |      |
| Integration tests           |      |
| CI/CD                 |      |

---

## 3. l3689-Υπολογιστικό Νέφος και Διαχείριση Πόρων Κατά Μήκος Νεφών 

### 3.1 Στόχοι ενότητας

Η ενότητα επικεντρώνεται στη φιλοξενία και διαχείριση εφαρμογών σε περιβάλλοντα υπολογιστικού
νέφους, στη βέλτιστη αξιοποίηση πόρων και στη μεταφερσιμότητα υπηρεσιών μεταξύ παρόχων.

### 3.2 Αρχιτεκτονικό Πεδίο και Ρητός Περιορισμός (l3689)

Στο πλαίσιο της ενότητας **l3689**, η εργασία εστιάζει **αποκλειστικά** στη
διαχείριση του κύκλου ζωής υποδομών IaaS μέσω Terraform (prepare → deploy →
destroy). Η **διάθεση/εκτέλεση της επιχειρησιακής λογικής** (citizen-service JAR,
systemd service, runtime pipeline) **δεν απαιτείται από την εκφώνηση** και
αποτελεί **συνειδητή, τεκμηριωμένη σχεδιαστική επιλογή**.

Συγκεκριμένα, η φάση **prepare** παράγει AMI που περιλαμβάνει **μόνο το
περιβάλλον εκτέλεσης** (runtime) και όχι την εφαρμογή, ώστε να αναδεικνύεται ο
εκπαιδευτικός στόχος της ενότητας: **διαχείριση υποκείμενων πόρων νέφους** και
όχι αυτοματοποίηση παράδοσης λογισμικού.

### 3.3 Μελλοντική επέκταση (placeholder)

Στο παρόν στάδιο, το έργο εστιάζει στην υλοποίηση της εφαρμογής και της γραμμής CI/CD.
Η πλήρης αξιοποίηση σε περιβάλλον cloud (π.χ. χρήση IaaS/PaaS, deployment σε cloud provider)
θα υλοποιηθεί σε επόμενη φάση της εργασίας, με στόχο να συνδεθεί άμεσα με τις έννοιες
της ενότητας l3689.

---

## 4. l3690-Δοχειοποίηση Εφαρμογών (Application Containerisation) 

### 4.1 Στόχοι ενότητας

Η ενότητα αφορά στη συσκευασία εφαρμογών σε containers (π.χ. Docker), στην περιγραφή του
περιβάλλοντος εκτέλεσης και στη διασφάλιση αναπαραγωγιμότητας μεταξύ διαφορετικών συστημάτων.

### 4.2 Υλοποίηση στο παρόν έργο

Η δοχειοποίηση εφαρμόζεται αποκλειστικά στο module `citizen-service` (REST API),
με πλήρη τεκμηρίωση στο `docker/README.md`. Συνοπτικά περιλαμβάνει:

- **Multi-stage Dockerfile** με Maven build και JRE runtime, με υποστήριξη multi-module build
 (συμπεριλαμβάνεται το `citizen-domain`).
- **Εκτέλεση ως μη-ριζικός χρήστης** και μικρότερο τελικό image.
- **Scripts διαχείρισης** (`docker/build.sh`, `docker/startup.sh`, `docker/shutdown.sh`)
 για build, εκκίνηση και τερματισμό των δοχείων.
- **Docker Compose** με υπηρεσίες `citizen-service` και `db` (MySQL),
 custom network και **persistent volume** `citizen-db-data` στο `/var/lib/mysql`.
- **Βασικές πρακτικές ασφάλειας**: read-only filesystem, `no-new-privileges`,
 και μη έκθεση θυρών της βάσης στο τοπικό σύστημα.

Εκτέλεση με Docker Compose:

```bash
cd docker
docker compose up -d
```

Τερματισμός:

```bash
cd docker
docker compose down
```

---

## 5. l3691-Ενορχήστρωση Δοχείων Εφαρμογών κατά Μήκος Πόρων 

### 5.1 Στόχοι ενότητας

Η ενότητα αυτή αναφέρεται στη διαχείριση και ενορχήστρωση πολλαπλών containers
σε κατανεμημένα περιβάλλοντα (π.χ. Kubernetes), στη διαθεσιμότητα και στην κλιμάκωση.

### 5.2 Μελλοντική επέκταση (placeholder)

Σε μελλοντική φάση προβλέπεται η:

- περιγραφή σεναρίων ανάπτυξης της εφαρμογής σε περιβάλλον ενορχήστρωσης
- απεικόνιση των υπηρεσιών (REST API, βάση δεδομένων, client) ως ξεχωριστών services
- σύνδεση των πρακτικών ενορχήστρωσης με τις έννοιες της ενότητας l3691
